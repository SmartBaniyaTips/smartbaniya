{{ $currentLang := .Site.Language.Lang }}
{{ $translations := .Translations }}

<div class="language-switcher">
  {{ range .Site.Languages }}
    {{ if ne .Lang $currentLang }}
      {{ $translated := index $translations .Lang }}
      {{ if $translated }}
        <a href="{{ $translated.RelPermalink }}">{{ .LanguageName }}</a>
      {{ else }}
        <a href="{{ .Lang | relLangURL }}">{{ .LanguageName }}</a>
      {{ end }}
    {{ end }}
  {{ end }}
</div>
